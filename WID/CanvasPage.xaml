<Page
    x:Class="WID.CanvasPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:WID"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:animatedvisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals"
    mc:Ignorable="d"
    >

    <Page.Background>
        <AcrylicBrush
            BackgroundSource="HostBackdrop"
            TintColor="Black"
            TintOpacity="0.6"
            FallbackColor="Black" />
    </Page.Background>
    

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <Grid
            x:Name="TitleBar"
            Background="Transparent"
            Width="Auto"
            Height="Auto"
             >
            <TextBlock
                x:Name="tbAppTitle"
                FontFamily="Segoe UI Variable"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                />
            <muxc:ProgressBar
                x:Name="pbFileStatus"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Width="512"
                Value="0"
                IsIndeterminate="False"
                ShowPaused="False"
                ShowError="False"
                />
        </Grid>

        <Popup
            x:Name="ppTextTools"
            Loaded="ToolPopupLoaded"
            Height="Auto"
            HorizontalAlignment="Center"
            VerticalAlignment="Top"
            VerticalOffset="40"
            IsOpen="True"
            Opacity="0"
            IsHitTestVisible="False"
            >
            <Popup.OpacityTransition>
                <ScalarTransition />
            </Popup.OpacityTransition>
            
            <Border
                x:Name="bdTextTools"
                BorderThickness="4"
                CornerRadius="8"
                >
                <Border.Background>
                    <AcrylicBrush
                        BackgroundSource="HostBackdrop"
                        TintColor="Black"
                        TintOpacity="0.6"
                        FallbackColor="Black"
                        />
                </Border.Background>
                <StackPanel
                    Orientation="Horizontal"
                    HorizontalAlignment="Stretch"
                    Spacing="10"
                    Margin="10"
                    >
                    <Button
                        Click="ToggleBoldText"
                        Content="B"
                        FontWeight="Bold"
                        />
                    <Button
                        Click="ToggleItalicText"
                        Content="I"
                        FontStyle="Italic"
                        />
                    <Button
                        Click="ToggleUnderlinedText"
                        >
                        <TextBlock
                            Text="U"
                            TextDecorations="Underline"
                            />
                    </Button>
                    <Button
                        Click="ToggleStrikethroughText"
                        >
                        <TextBlock
                            Text="S"
                            TextDecorations="Strikethrough"
                            />
                    </Button>
                    <Button
                        Click="ToggleSuperscriptText"
                        >
                        Superscript
                    </Button>
                    <Button
                        Click="ToggleSubscriptText"
                        >
                        Subscript
                    </Button>
                    <TextBox
                        Width="200"
                        PlaceholderText="Search"
                        HorizontalAlignment="Stretch"
                        />
                    <Button
                        Click="DeleteCurrentTextBox"
                        Foreground="Red"
                        >
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE74D;" />
                    </Button>
                </StackPanel>
            </Border>
        </Popup>


        <StackPanel
            Grid.Row="0"
            Height="36"
            Width="Auto"
            Orientation="Horizontal"
            Spacing="10"
            >
            <Button
                Click="PageBack"
                Background="Transparent"
                BorderBrush="Transparent"
                ToolTipService.ToolTip="Go Back"
                >
                <muxc:AnimatedIcon>
                    <muxc:AnimatedIcon.Source>
                        <animatedvisuals:AnimatedBackVisualSource />
                    </muxc:AnimatedIcon.Source>
                    <muxc:AnimatedIcon.FallbackIconSource>
                        <muxc:FontIconSource FontFamily="Segoe Fluent Icons" Glyph="&#xE112;" />
                    </muxc:AnimatedIcon.FallbackIconSource>
                </muxc:AnimatedIcon>
            </Button>
            <muxc:DropDownButton
                Background="Transparent"
                BorderBrush="Transparent"
                ToolTipService.ToolTip="File Options"
                >
                <muxc:DropDownButton.Content>
                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE160;" />
                </muxc:DropDownButton.Content>
                <muxc:DropDownButton.Flyout>
                    <MenuFlyout
                        Placement="BottomEdgeAlignedLeft"
                        >
                        <MenuFlyoutItem
                            Text="Save File"
                            Click="SaveFile"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="S" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE105;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator />
                        <MenuFlyoutItem
                            x:Name="btUndoStroke"
                            Text="Undo"
                            Click="UndoStroke"
                            IsEnabled="False"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="Z" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE10E;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem
                            x:Name="btRedoStroke"
                            Text="Redo"
                            Click="RedoStroke"
                            IsEnabled="False"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="Y" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE10D;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </muxc:DropDownButton.Flyout>
            </muxc:DropDownButton>
            <muxc:DropDownButton
                Background="Transparent"
                BorderBrush="Transparent"
                ToolTipService.ToolTip="Add item"
                >
                <muxc:DropDownButton.Content>
                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE109;" />
                </muxc:DropDownButton.Content>
                <muxc:DropDownButton.Flyout>
                    <MenuFlyout>
                        <MenuFlyoutItem
                            Click="AddPageClicked"
                            Text="Add empty page"
                            ToolTipService.ToolTip="Add empty page (with default template)"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="Add" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE160;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem
                            Click="ImportFromFile"
                            Text="Import file"
                            ToolTipService.ToolTip="Import from an image or PDF file"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="I" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE8B5;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem
                            Click="OpenCameraForFileImport"
                            Text="Open camera"
                            ToolTipService.ToolTip="Open the camera to capture a document"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="O" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE722;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem
                            Click="AddTextToCurrentPage"
                            Text="Add text"
                            ToolTipService.ToolTip="Add an editable text block to the current page"
                            >
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="T" Modifiers="Control" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE8D2;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </muxc:DropDownButton.Flyout>
            </muxc:DropDownButton>
            <ToggleButton
                Click="OpenPageOverview"
                Background="Transparent"
                BorderBrush="Transparent"
                ToolTipService.ToolTip="Open page overview"
                >
                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE82D;" />
            </ToggleButton>
        </StackPanel>

        <muxc:TeachingTip
            x:Name="ttInfoPopup"
            IsOpen="False"
            PreferredPlacement="RightTop"
            />

        <SplitView
            Grid.Row="1"
            x:Name="svPageOverview"
            PaneBackground="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
            OpenPaneLength="400"
            DisplayMode="Inline"
            >
            <SplitView.Pane>
                <Grid
                    BorderBrush="{ThemeResource SystemControlAcrylicWindowBrush}"
                    BorderThickness="0, 0, 4, 0"
                    >
                    <GridView
                        x:Name="gvThumbnails"
                        Height="Auto"
                        Width="Auto"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Loaded="ThumbnailGridViewLoaded"
                        AllowDrop="True"
                        CanReorderItems="True"
                        CanDragItems="True"
                        ReorderMode="Enabled"
                        DragItemsCompleted="PagesReordered"
                        >
                        <GridView.ItemContainerTransitions>
                            <TransitionCollection>
                                <EntranceThemeTransition
                                    IsStaggeringEnabled="True"
                                    />
                            </TransitionCollection>
                        </GridView.ItemContainerTransitions>
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid
                                    Orientation="Horizontal"
                                    MaximumRowsOrColumns="2"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                    </GridView>
                </Grid>
            </SplitView.Pane>
            <ScrollViewer
                x:Name="svPageZoom"
                ZoomMode="Enabled"
                MinZoomFactor="0.1"
                MaxZoomFactor="10"
                IsVerticalScrollChainingEnabled="True"
                HorizontalScrollMode="Enabled"
                VerticalScrollMode="Enabled"
                HorizontalScrollBarVisibility="Hidden"
                VerticalScrollBarVisibility="Hidden"
                >
                <StackPanel
                    x:Name="spPageView"
                    Orientation="Vertical"
                    Spacing="20"
                    >
                    <StackPanel.ChildrenTransitions>
                        <TransitionCollection>
                            <EntranceThemeTransition />
                            <ReorderThemeTransition />
                        </TransitionCollection>
                    </StackPanel.ChildrenTransitions>
                </StackPanel>
            </ScrollViewer>
        </SplitView>

        <TextBlock x:Name="tbTest" Text="Hello" Grid.Row="2" />

        <InkToolbar
            x:Name="inkToolbar"
            Grid.Row="3"
            ActiveToolChanged="InkToolChanged"
            InkDrawingAttributesChanged="InkToolChanged"
            InitialControls="PensOnly"
            HorizontalAlignment="Center"
            >
            <InkToolbarEraserButton
                Checked="EraserChecked"
                Unchecked="EraserUnchecked"
                >
                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE75C;" />
            </InkToolbarEraserButton>
            <InkToolbarCustomToggleButton
                Checked="RulerChecked"
                Unchecked="RulerUnchecked"
                >
                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xECC6;" />
            </InkToolbarCustomToggleButton>
            <InkToolbarCustomToggleButton
                Checked="ProtractorChecked"
                Unchecked="ProtractorUnchecked"
                >
                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xF0B4;" />
            </InkToolbarCustomToggleButton>
        </InkToolbar>
    </Grid>
</Page>
